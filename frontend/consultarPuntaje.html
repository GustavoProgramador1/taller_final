<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Side Navigation Bar</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
</head>

<body class="flex flex-col h-screen bg-gray-100 dark:bg-gray-800">
    <div class="flex flex-grow">
        <aside class="flex flex-col w-64 h-screen px-4 py-8 overflow-y-auto bg-white border-r rtl:border-r-0 rtl:border-l dark:bg-gray-900 dark:border-gray-700">
            <img class="w-auto" src="https://github.com/DaniValMelli/Tallercss3/blob/main/logomicredito.png?raw=true" alt="">
        
            <div class="flex flex-col justify-between flex-1 mt-6">
                <nav>
                    <a class="flex items-center px-4 py-2 rounded-md text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2" href="consultarPuntaje.html">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-6">
                            <path fill-rule="evenodd" d="M12 1.5a.75.75 0 0 1 .75.75V4.5a.75.75 0 0 1-1.5 0V2.25A.75.75 0 0 1 12 1.5ZM5.636 4.136a.75.75 0 0 1 1.06 0l1.592 1.591a.75.75 0 0 1-1.061 1.06l-1.591-1.59a.75.75 0 0 1 0-1.061Zm12.728 0a.75.75 0 0 1 0 1.06l-1.591 1.592a.75.75 0 0 1-1.06-1.061l1.59-1.591a.75.75 0 0 1 1.061 0Zm-6.816 4.496a.75.75 0 0 1 .82.311l5.228 7.917a.75.75 0 0 1-.777 1.148l-2.097-.43 1.045 3.9a.75.75 0 0 1-1.45.388l-1.044-3.899-1.601 1.42a.75.75 0 0 1-1.247-.606l.569-9.47a.75.75 0 0 1 .554-.68ZM3 10.5a.75.75 0 0 1 .75-.75H6a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 10.5Zm14.25 0a.75.75 0 0 1 .75-.75h2.25a.75.75 0 0 1 0 1.5H18a.75.75 0 0 1-.75-.75Zm-8.962 3.712a.75.75 0 0 1 0 1.061l-1.591 1.591a.75.75 0 1 1-1.061-1.06l1.591-1.592a.75.75 0 0 1 1.06 0Z" clip-rule="evenodd" />
                          </svg>
                        <span class="mx-4">Consultar Puntaje</span>
                    </a>
        
                    <a class="flex items-center px-4 py-2 mt-5 rounded-md text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2" href="creditosActivos.html">
                        
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-6">
                            <path d="M10.464 8.746c.227-.18.497-.311.786-.394v2.795a2.252 2.252 0 0 1-.786-.393c-.394-.313-.546-.681-.546-1.004 0-.323.152-.691.546-1.004ZM12.75 15.662v-2.824c.347.085.664.228.921.421.427.32.579.686.579.991 0 .305-.152.671-.579.991a2.534 2.534 0 0 1-.921.42Z" />
                            <path fill-rule="evenodd" d="M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25ZM12.75 6a.75.75 0 0 0-1.5 0v.816a3.836 3.836 0 0 0-1.72.756c-.712.566-1.112 1.35-1.112 2.178 0 .829.4 1.612 1.113 2.178.502.4 1.102.647 1.719.756v2.978a2.536 2.536 0 0 1-.921-.421l-.879-.66a.75.75 0 0 0-.9 1.2l.879.66c.533.4 1.169.645 1.821.75V18a.75.75 0 0 0 1.5 0v-.81a4.124 4.124 0 0 0 1.821-.749c.745-.559 1.179-1.344 1.179-2.191 0-.847-.434-1.632-1.179-2.191a4.122 4.122 0 0 0-1.821-.75V8.354c.29.082.559.213.786.393l.415.33a.75.75 0 0 0 .933-1.175l-.415-.33a3.836 3.836 0 0 0-1.719-.755V6Z" clip-rule="evenodd" />
                          </svg>
                        
                        <span class="mx-4">Créditos Activos</span>
                    </a>
        
                    <a class="flex items-center px-4 py-2 mt-5 rounded-md text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2" href="deudasTotales.html">
                        
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-6">
                            <path fill-rule="evenodd" d="M3.75 3.375c0-1.036.84-1.875 1.875-1.875H9a3.75 3.75 0 0 1 3.75 3.75v1.875c0 1.036.84 1.875 1.875 1.875H16.5a3.75 3.75 0 0 1 3.75 3.75v7.875c0 1.035-.84 1.875-1.875 1.875H5.625a1.875 1.875 0 0 1-1.875-1.875V3.375Zm10.5 1.875a5.23 5.23 0 0 0-1.279-3.434 9.768 9.768 0 0 1 6.963 6.963A5.23 5.23 0 0 0 16.5 7.5h-1.875a.375.375 0 0 1-.375-.375V5.25ZM12 10.5a.75.75 0 0 1 .75.75v.028a9.727 9.727 0 0 1 1.687.28.75.75 0 1 1-.374 1.452 8.207 8.207 0 0 0-1.313-.226v1.68l.969.332c.67.23 1.281.85 1.281 1.704 0 .158-.007.314-.02.468-.083.931-.83 1.582-1.669 1.695a9.776 9.776 0 0 1-.561.059v.028a.75.75 0 0 1-1.5 0v-.029a9.724 9.724 0 0 1-1.687-.278.75.75 0 0 1 .374-1.453c.425.11.864.186 1.313.226v-1.68l-.968-.332C9.612 14.974 9 14.354 9 13.5c0-.158.007-.314.02-.468.083-.931.831-1.582 1.67-1.694.185-.025.372-.045.56-.06v-.028a.75.75 0 0 1 .75-.75Zm-1.11 2.324c.119-.016.239-.03.36-.04v1.166l-.482-.165c-.208-.072-.268-.211-.268-.285 0-.113.005-.225.015-.336.013-.146.14-.309.374-.34Zm1.86 4.392V16.05l.482.165c.208.072.268.211.268.285 0 .113-.005.225-.015.336-.012.146-.14.309-.374.34-.12.016-.24.03-.361.04Z" clip-rule="evenodd" />
                          </svg>
                        
                        <span class="mx-4">Deudas Totales</span>
                    </a>
        
                    <a class="flex items-center px-4 py-2 mt-5 rounded-md text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2" href="reportesNegativos.html">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-6">
                            <path fill-rule="evenodd" d="M3 2.25a.75.75 0 0 1 .75.75v.54l1.838-.46a9.75 9.75 0 0 1 6.725.738l.108.054A8.25 8.25 0 0 0 18 4.524l3.11-.732a.75.75 0 0 1 .917.81 47.784 47.784 0 0 0 .005 10.337.75.75 0 0 1-.574.812l-3.114.733a9.75 9.75 0 0 1-6.594-.77l-.108-.054a8.25 8.25 0 0 0-5.69-.625l-2.202.55V21a.75.75 0 0 1-1.5 0V3A.75.75 0 0 1 3 2.25Z" clip-rule="evenodd" />
                          </svg>
                        
                        
                        <span class="mx-4">Reportes Negativos</span>
                    </a>

                    <a class="flex items-center px-4 py-2 mt-5 rounded-md text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2" href="tarjetasCredito.html">
                        <span class="mx-4">Tarjetas</span>
                    </a>
                </nav>
            </div>
        </aside>
        <main class="flex-1 flex justify-center items-start bg-white">
            <div class="w-full max-w-lg p-6 bg-white rounded-lg mt-12">
                <!-- Título de la sección -->
                <h2 class="text-2xl font-bold text-center text-gray-700 mb-6">
                    Puntaje Datacrédito
                </h2>

                <!-- Formulario de consulta -->
                <form id="consultarPuntajeForm">
                    <div class="mb-4">
                        <label for="tipo-documento"
                            class="block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2">
                            Tipo de Documento
                        </label>
                        <select id="tipo-documento" name="tipo-documento"
                            class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                            <option value="CC">Cédula de Ciudadanía (CC)</option>
                            <option value="CE">Cédula de Extranjería (CE)</option>
                        </select>
                    </div>

                    <div class="mb-4">
                        <label for="numero-documento"
                            class="block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2">
                            Número de Documento
                        </label>
                        <input type="text" id="numero-documento" name="numero-documento"
                            placeholder="Ingrese su número de documento"
                            class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                            required>
                    </div>

                    <div class="flex items-center justify-between">
                        <button type="submit"
                            class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline">
                            Consultar Puntaje
                        </button>
                    </div>
                </form>

                <div class="relative w-40 h-40 mt-10">
                    <!-- Fondo del círculo -->
                    <svg class="absolute top-0 left-0 w-full h-full transform rotate-180">
                        <circle cx="50%" cy="50%" r="45%" fill="none" stroke="#e5e7eb" stroke-width="10"></circle>
                    </svg>
                    <!-- Barra animada -->
                    <svg class="absolute top-0 left-0 w-full h-full transform rotate-180">
                        <circle id="progress-circle" cx="50%" cy="50%" r="45%" fill="none" stroke="url(#gradient)"
                            stroke-width="10" stroke-dasharray="283" stroke-dashoffset="283" stroke-linecap="round">
                        </circle>
                        <defs>
                            <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="0%">
                                <stop offset="0%" stop-color="#ef4444" />
                                <stop offset="50%" stop-color="#facc15" />
                                <stop offset="100%" stop-color="#22c55e" />
                            </linearGradient>
                        </defs>
                    </svg>
                    <!-- Número -->
                    <div class="absolute inset-0 flex items-center justify-center text-2xl font-bold text-gray-800">
                        <span id="progress-text">?</span>
                    </div>
                </div>

                <script>
                    document.getElementById('consultarPuntajeForm').addEventListener('submit', async (e) => {
                        e.preventDefault();
                        const tipoDocumento = document.getElementById('tipo-documento').value;
                        const numeroDocumento = document.getElementById('numero-documento').value;

                        const token = localStorage.getItem('token') ?? "";

                        try {
                            const response = await fetch(`http://localhost:3000/api/clientes/puntaje/${tipoDocumento}/${numeroDocumento}`, {
                                method: 'GET',
                                headers: {
                                    'Content-Type': 'application/json',
                                    'Authorization': `Bearer ${token}`
                                },
                            });

                            if (!response.ok) {
                                throw new Error('Credenciales inválidas');
                            }

                            const { puntaje_datacredito } = await response.json();

                            fillProgressBar(puntaje_datacredito);
                        } catch (error) {
                            document.getElementById('result').innerText = error.message;
                        }
                    });

                    function fillProgressBar(value) {
                        const max = 1000;
                        const min = 300;

                        const progressText = document.getElementById('progress-text');
                        const progressCircle = document.getElementById('progress-circle');

                        progressText.textContent = value;

                        // Calcular el porcentaje basado en el puntaje
                        const percentage = ((value - min) / (max - min)) * 100;

                        // Calcular el offset para el círculo
                        const circleCircumference = 2 * Math.PI * 45; // Circunferencia del círculo
                        const offset = circleCircumference - (percentage / 100) * circleCircumference;
                        progressCircle.style.strokeDashoffset = offset;

                        // Asignar color según el rango del puntaje
                        if (value >= 800) {
                            progressCircle.style.stroke = '#2ECC71'; // Verde (Excelente)
                        } else if (value >= 700) {
                            progressCircle.style.stroke = '#3498DB'; // Azul (Bueno)
                        } else if (value >= 600) {
                            progressCircle.style.stroke = '#F1C40F'; // Amarillo (Regular)
                        } else if (value >= 500) {
                            progressCircle.style.stroke = '#E67E22'; // Naranja (Bajo)
                        } else {
                            progressCircle.style.stroke = '#E74C3C'; // Rojo (Malo)
                        }
                    }


                </script>


            </div>
        </main>
    </div>

    <footer class="bg-gray-800 text-white p-4 mt-auto">
        <div class="flex justify-center">
            <p class="text-center">© 2024 Mi Aplicación. Todos los derechos reservados.</p>
        </div>
    </footer>

</body>

</html>